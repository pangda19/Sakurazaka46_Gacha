<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <!-- Open Graph metadata wait for link -->
    <meta property="og:title" content="SakuSongGacha - Which Sakurazaka46 song fits your mood today?" />
    <meta property="og:description" content="Spin the Gacha and discover your Sakurazaka46 song of the day!" />
    <meta property="og:image" content="https://pangda19.github.io/Sakurazaka46_Gacha/image/og_image.jpg" />
    <meta property="og:url" content="https://sakurazaka101.com/staging/sakusonggacha/" />
    <meta property="og:type" content="website" />
    <!--  twitter card  -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SakuSongGacha">
    <meta name="twitter:description" content="Spin the capsule and discover your Sakurazaka46 song of the day!">
    <meta name="twitter:image" content="https://pangda19.github.io/Sakurazaka46_Gacha/image/og_image.jpg">
    <title>Sakurazaka46 Song Gacha</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #ca2371;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            padding-top: env(safe-area-inset-top);
        }

        .inter-regular {
            font-family: "Inter", sans-serif;
            font-weight: 400;
            font-style: normal;
        }

        .container {
            text-align: center;
            max-width: 600px;
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center; /* ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
            align-items: center;     /* ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
            padding: env(safe-area-inset-top) 1rem 1rem;
        }


        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Welcome Page */
        .welcome-page img {
            width: 100%;
            max-width: 400px;
            margin-bottom: 2rem;
            z-index: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;

        }

        .start-btn {
            background: linear-gradient(45deg, #ffdce8, #FFCFCF);
            border: none;
            padding: 10px 40px;
            font-size: 1rem;
            color: rgb(0, 0, 0);
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        #sakusenlogo {
            width: 100%;
            max-width: 50px;
            margin-top: 2.5rem;
            margin-left: auto;
            margin-right: auto;
        }

        /* Gacha Page */
        .gacha-container {
            position: relative;
            margin: 2rem auto;
        }

        .gacha-machine {
            width: 400px;
            height: 410px;
            background: transparent;
            border-radius: 20px;
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: none; 
        }

        h2 {
            margin-bottom: 10px;
        }

        .gacha-screen {
            width: 300px;
            height: 300px;
            background: transparent;
            border-radius: 15px;
            margin: 10px auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .gacha-capsule {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gacha-gif {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .gacha-handle {
            width: 100px;
            height: 46px;
            background: #ffd700;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-radius: 50px;
            margin: 0 auto 20px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .gacha-handle:hover {
            background: #ffed4e;
            transform: scale(1.05);
        }

        .gacha-handle::after {
            content: 'SPIN';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            color: #333;
            font-size: 0.8rem;
        }

        @keyframes handlePull {
            0% { transform: translateY(0px); }
            50% { transform: translateY(6px); }
            100% { transform: translateY(0px); }
        }

        .gacha-handle.pulling {
            animation: handlePull 0.5s ease-in-out;
        }


        /* Result Page */
        h3 {
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .result-container {
            padding-top: 2rem;
            width: auto;
            height: auto;
            max-width: 100%;
            padding-top: 1rem;
            padding: 2rem;
        }

        .song-image {
            max-width: 100%;
            width: 300px;
            margin: 0 auto 1rem;
            display: block;
            object-fit: cover;
        }


        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            padding-left: 5vw;
            padding-right: 5vw;
        }


        .btn {
            background: linear-gradient(45deg, #000000, #294a4f);
            border: none;
            padding: 12px 15px;
            font-size: 1rem;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-decoration: none;
            display: inline-block;
            width: 150px;
            text-align: center;
            max-width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .btn.secondary {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .btn.success {
            background: linear-gradient(45deg, #56ab2f, #06ab6f);
        }

        .back-to-home {
            font-size: 0.8rem;
            margin: 20px;
            display: block;
            text-decoration: underline;
            color: white;
        }


        /* Responsive Design */
        @media (max-width: 768px) {
            .gacha-machine {
                width: 90vw;  
                height: auto; 
            }

            .gacha-screen {
                width: 80vw;
                height: 80vw;
            }

            .gacha-gif {
                width: 100%;
                height: 100%;
            }
    
                    
            .result-container {
                margin: 1rem;
                padding: 1rem;
            }
            
            .song-title {
                font-size: 1.5rem;
            }
        }

        /* Fade in animation */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Welcome Page -->
        <div id="welcome-page" class="page active welcome-page">
            <img src="image/index_head2.png"> 
            <button class="start-btn" onclick="goToGacha()">Start</button>
            <img src="image/Sakusen_logo.png" id="sakusenlogo" class="sakusenlogo">
        </div>

        <!-- Gacha Page -->
        <div id="gacha-page" class="page">
            <h2> Sakurazaka46 Song Gacha </h2>
            <p>Turn the handle to get your song!</p>
            <div class="gacha-container">
                <div class="gacha-machine">
                    <div class="gacha-screen">
                        <div class="gacha-capsule" id="capsule">
                            <img src="image/gacha.gif" class="gacha-gif" alt="Gacha Capsule">
                        </div>
                    </div>
                    <div class="gacha-handle" id="gacha-handle" onclick="spinGacha()"></div>
                </div>
            </div>
        </div>

        <!-- Animation Page (‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Result) -->
        <div id="gacha-anim-page" class="page">
            <img src="image/gasha.pop.gif" alt="Spinning..." style="width: 200px; margin: 100px auto; display: block;">
        </div>


        <!-- Result Page -->
        <div id="result-page" class="page">
            <div class="result-container">
                <h3> Your Sakurazaka46 song for today is: </h3>
                <a id="song-image-link" href="" download>
                    <img id="song-image" class="song-image" src="" alt="Song Cover">
                </a>
                <p style="font-size: 0.9rem; margin: 20px;">Long press the image to save it!</p>
                <p class="song-lyric" id="song-lyric"></p>
                <div class="button-group">
                    <a id="listen-btn" class="btn success" target="_blank">Listen</a>
                    <button class="btn" onclick="shareToTwitter()">Share on X</button>
                    <button class="btn secondary" onclick="goToGacha()"> Start Over</button>
                </div>
                <a href="https://sakurazaka101.com" class="back-to-home">Go to Sakurazaka101</a>
            </div>
        </div>
    </div>

    <script>
        const songs = [
            {
                // Make or Break //
                title: "Make or Break",
                image: "image/result_Mob.jpg",
                url: "https://www.youtube.com/watch?v=nTxTTZ0QLrI"
            },
            {
                // Shindafuri //
                title: "Shindafuri",
                image: "image/result_Shindafuri.jpg",
                url: "https://www.youtube.com/watch?v=WNH_ReRMt5k"
                
            },
            {
                // Saishuu no Chikatetsu ni Notte //
                title: "Saishuu no Chikatetsu ni Notte",
                image: "image/result_Saishu.jpg",
                url: "https://open.spotify.com/track/4d6fEBAjexpIXkh5pg30pe?si=f4d947505eb64969"
                
            },
            {
                // Omotta Yori mo Sabishikunai //
                title: "Omotta Yori mo Sabishikunai",
                image: "image/result_omotta.jpg",
                url: "https://youtu.be/D0W44Z3D3wo?si=qczX_mg0M-PBuGcz"
            },
            {
                // Danzetsu //
                title: "Danzetsu",
                image: "image/result_Danzetsu.jpg",
                url: "https://open.spotify.com/track/4Den6HjuGSHIz0y9ZV4CsR?si=2c07a05b805d4f5d"
            },
            {
                // Minato-ku Parsley //
                title: "Minato-ku Parsley",
                image: "image/result_minatoku.jpg",
                url: "https://www.youtube.com/watch?v=aLu4oyQ2zdw"
            },
            {
                // Boku no Dilemma //
                title: "Boku no Dilemma",
                image: "image/result_dilemma_1.jpg",
                url: "https://www.youtube.com/watch?v=ZBk4V-uqcXs"
            },
            {
                // Boku no Dilemma //
                title: "Boku no Dilemma",
                image: "image/result_dilemma_2.jpg",
                url: "https://www.youtube.com/watch?v=ZBk4V-uqcXs"
            },
            {
                // I'm in  //
                title: "I'm in ",
                image: "image/result_imin.jpg",
                url: "https://open.spotify.com/track/2Y51hgeUpf5DgH4X8NgJUn?si=4646f3f5f7d9473e"
            },
            {
                // Ikutsu no Koro ni Modoritai no ka?  //
                title: "Ikutsu no Koro ni Modoritai no ka?",
                image: "image/result_Ikutsu.jpg",
                url: "https://www.youtube.com/watch?v=7xx66mR_HeE"
            },
            {
                // Renai Musou //
                title: "Renai Musou",
                image: "image/result_renai.jpg",
                url: "https://open.spotify.com/track/5vRGSkQiKlJudkJ2vUKIOe?si=ddd8af7a24d14024"
            },
            {
                // Abura wo Sase! //
                title: "Abura wo Sase!",
                image: "image/result_abura.jpg",
                url: "https://youtu.be/x9a0_2aGeWU"
            },
            {
                // Shoninyokkyu //
                title: "Shoninyokkyu",
                image: "image/result_Shonin.jpg",
                url: "https://youtu.be/x_BjvhMW9TE"
            },
            {
                // Jamaica Beer //
                title: "Jamaica Beer",
                image: "image/result_JamaicaBeer.jpg",
                url: "https://open.spotify.com/track/37h3M4ZYJgSRy0cXArsH59"
            },
            {
                // Isshun no Uma //
                title: "Isshun no Uma",
                image: "image/result_Isshun.jpg",
                url: "https://open.spotify.com/track/7jLbrfs3YtWO232XEU3iD1?si=5e2759f81a5a433c"
            },
            { 
                // Start over! //
                title: "Start over!",
                image: "image/result_Startover.jpg",
                url: "https://www.youtube.com/watch?v=YJRFD1AdaUE"
            },
            { 
                // Yaru Shika Nai Jan //
                title: "Yaru Shika Nai Jan",
                image: "image/result_yaru.jpg",
                url: "https://open.spotify.com/track/5HlMKsatk8faYUEiy7d0El?si=31e1c1931a0f4605"
            },
            { 
                // Sono hi made //
                title: "Sono hi made",
                image: "image/result_sonohi.jpg",
                url: "https://www.youtube.com/watch?v=F2lWsUJotmc"
            },
            { 
                // Cool //
                title: "Cool",
                image: "image/result_cool.jpg",
                url: "https://youtu.be/XEKPn3WbksE"
            },
            { 
                // Addiction //
                title: "Addiction",
                image: "image/result_addiction.jpg",
                url: "https://www.youtube.com/watch?v=ReuFa_D1Vok"
            },
            { 
                // Hikikomoru Jikan wa Nai //
                title: "Hikikomoru Jikan wa Nai",
                image: "image/result_hiki.jpg",
                url: "https://youtu.be/KYvq8-xY1Gg"
            },
            { 
                // Honshitsuteki na Koto //
                title: "Honshitsuteki na Koto",
                image: "image/result_Honshi.jpg",
                url: "https://youtu.be/iZhbx2mcmug"
            },
            { 
                // Jouken hansha de nakete kuru //
                title: "Jouken hansha de nakete kuru",
                image: "image/result_Jouken.jpg",
                url: "https://www.youtube.com/watch?v=uxC0v1902dE"
            },
            { 
                // Zutto Haru Dattara Naa //
                title: "Zutto Haru Dattara Naa",
                image: "image/result_Zutto.jpg",
                url: "https://open.spotify.com/track/1ES3bgzwzP257JequGIXjB?si=010355bc79804497"
            },
            { 
                // Masatsukeisu //
                title: "Masatsukeisu",
                image: "image/result_masatsu.jpg",
                url: "https://youtu.be/D8piCp9XMKA?si=DfkByzQsukLLFxQU"
            },
            { 
                // Natsu no Chikamichi //
                title: "Natsu no Chikamichi",
                image: "image/result_nutsuno.jpg",
                url: "https://youtu.be/nV1DHIWSdEo?si=cPYFuIaGpMQMmaXq"
            },
            { 
                // Anthem time //
                title: "Anthem time",
                image: "image/result_Anthem.jpg",
                url: "https://open.spotify.com/track/5NAhakYBfDrnPwclaAqKQT?si=79032ab26b5b4560"
            },
            { 
                // Sakurazaka no Uta //
                title: "Sakurazaka no Uta",
                image: "image/result_sakuuta.jpg",
                url: "https://open.spotify.com/track/6c49BNfzR0zzy2VNx6xU7q?si=ab9bf4a04b9e4159"
            },
            { 
                // Moshikashitara Shinjitsu //
                title: "Moshikashitara Shinjitsu",
                image: "image/result_moshika.jpg",
                url: "https://open.spotify.com/track/1OIrd9dU5JOxAO8cXvQYGQ?si=2cdad01a966144d4"
            },
            { 
                // Nando LOVE SONG no Kashi wo Yomikaeshita darou //
                title: "Nando LOVE SONG no Kashi wo Yomikaeshita darou",
                image: "image/result_nando.jpg",
                url: "https://www.youtube.com/watch?v=tltXZSiAAdQ"
            },
            { 
                // One-way stairs //
                title: "One-way stairs",
                image: "image/result_One-way.jpg",
                url: "https://open.spotify.com/track/5hc0f76iSuGeWAovzeRDzM?si=c87fb45b929e44b8"
            },
        ];

        let currentSong = null;

        function goToGacha() {
            hideAllPages();
            document.getElementById('gacha-page').classList.add('active', 'fade-in');
        }

        function goToResult() {
            hideAllPages();
            document.getElementById('result-page').classList.add('active', 'fade-in');
        }

        function hideAllPages() {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });
        }

        function spinGacha() {
            const handle = document.getElementById('gacha-handle');
            const capsule = document.getElementById('capsule');
            
            // Show result after capsule animation completes
            setTimeout(() => {
                capsule.classList.remove('spinning');
                handle.style.pointerEvents = 'auto';
                showResult();
            }, 200);
        }

        function goToResult() {
            hideAllPages();

            // ‡πÇ‡∏ä‡∏ß‡πå‡∏´‡∏ô‡πâ‡∏≤ animation ‡∏Å‡πà‡∏≠‡∏ô
            document.getElementById('gacha-anim-page').classList.add('active');

            // ‡∏´‡∏•‡∏±‡∏á 2 ‡∏ß‡∏¥ ‡∏Ñ‡πà‡∏≠‡∏¢‡πÇ‡∏ä‡∏ß‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            setTimeout(() => {
                hideAllPages();
                document.getElementById('result-page').classList.add('active', 'fade-in');
            }, 2000);
        }


        function showResult() {
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°
            const randomIndex = Math.floor(Math.random() * songs.length);
            currentSong = songs[randomIndex];

            const songTitleElement = document.getElementById('song-title');
            if (songTitleElement) {
                songTitleElement.textContent = currentSong.title;
            }

            const imageElement = document.getElementById('song-image');
            const imageLink = document.getElementById('song-image-link');

            imageElement.src = currentSong.image;
            imageElement.alt = currentSong.title;
            imageLink.href = currentSong.image;

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏∏‡πà‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á
            const listenBtn = document.getElementById('listen-btn');
            if (currentSong.url) {
                listenBtn.href = currentSong.url;
                listenBtn.style.display = "inline-block";
            } else {
                listenBtn.href = "#";
                listenBtn.style.display = "none";
            }

            // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            goToResult();
        }

        function saveResult() {
            if (!currentSong) return;
            
            // Create a simple "save" by downloading the result as text
            const resultText = `My Sakurazaka46 song today: ${currentSong.title}\nGenerated by Sakurazaka46 Song Selector`;
            const blob = new Blob([resultText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sakurazaka46-song-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            // Show feedback
            alert('Result saved! üì±');
        }

function shareToTwitter() {

    if (!currentSong) return;

            const gameUrl = 'https://sakurazaka101.com/sakusonggacha/'; // link waiting
            const tweetText =
                `üå∏ My #Sakurazaka46 song for today is "${currentSong.title}"! üéµ\n\n` +
                `What's your song for today?\nFind out with the Sakurazaka46 Song Gacha!‚ú®\n\n` +
                `${gameUrl}\n\n` +
                `#Ê´ªÂùÇ46_JPOPSoundCapsule\n#Ê´ªÂùÇ46 #SakuSongGacha`;

            const tweetUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;

            window.open(tweetUrl, '_blank');
        }

    </script>
</body>
</html>
